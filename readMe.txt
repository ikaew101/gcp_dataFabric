============================================================
 คู่มือการใช้งาน Terraform สำหรับ GCP Project (Data Pipeline)
============================================================

1. การตั้งค่าเบื้องต้น (ทำครั้งแรก หรือเมื่อเปลี่ยนเครื่อง)
------------------------------------------------------------
# 1.1 แก้ปัญหา PowerShell รันคำสั่งไม่ได้ (Run as Admin ถ้าจำเป็น)
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# 1.2 ติดตั้ง Terraform (ถ้ายังไม่มีในเครื่อง)
winget install Hashicorp.Terraform
(หมายเหตุ: หลังติดตั้งต้องปิด VS Code แล้วเปิดใหม่)

# 1.3 ล็อกอินเข้า Google Cloud (เพื่อให้ Terraform คุยกับ GCP ได้)
gcloud auth application-default login


2. ขั้นตอนการรัน Terraform (Routine Workflow)
------------------------------------------------------------
# 2.1 เริ่มต้นโปรเจกต์ (รันเมื่อสร้าง Folder ใหม่ หรือเพิ่ม Provider)
terraform init

# 2.2 ตรวจสอบแผนงาน (เช็คก่อนสร้างจริงเสมอ เพื่อดูว่าจะเกิดอะไรขึ้น)
terraform plan

# 2.3 ลงมือสร้าง (Deploy)
# ระบบจะถามยืนยัน ให้พิมพ์ 'yes' แล้วกด Enter
terraform apply


3. การล้างระบบ (Cleanup) *** สำคัญมาก ***
------------------------------------------------------------
# ลบทุกอย่างที่สร้างมา เพื่อป้องกันการเสียเงินฟรี
# ระบบจะถามยืนยัน ให้พิมพ์ 'yes' แล้วกด Enter
terraform destroy


4. ข้อควรระวัง (Troubleshooting Notes)
------------------------------------------------------------
* Project ID: อย่าลืมแก้ "YOUR_PROJECT_ID" ในไฟล์ main.tf ให้เป็น ID ของเรา
* การตั้งชื่อ (Naming Convention): 
  - Bucket: ต้องตัวเล็กหมด, ห้ามมี underscore (_), ใช้ขีดกลาง (-) ได้
  - Cloud Run: ต้องตัวเล็กหมด, ห้ามมี underscore (_), ใช้ขีดกลาง (-) ได้
* Error ซ้ำ: ถ้าแก้ code แล้ว ให้รัน 'terraform apply' ซ้ำได้เลย ไม่ต้องลบของเก่า